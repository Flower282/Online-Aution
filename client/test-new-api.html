<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Test provinces.open-api.vn</title>
    <style>
        body {
            font-family: Arial;
            padding: 20px;
            background: #1e1e1e;
            color: #fff;
        }

        select {
            padding: 10px;
            margin: 10px 0;
            width: 300px;
            font-size: 14px;
        }

        .info {
            color: #4fc3f7;
            margin: 10px 0;
        }

        pre {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>

<body>
    <h1>üß™ Test provinces.open-api.vn API</h1>

    <div class="info" id="status">Loading...</div>

    <label>Ch·ªçn T·ªânh/Th√†nh ph·ªë:</label>
    <select id="provinceSelect" onchange="loadDistricts(this.value)">
        <option value="">-- Ch·ªçn T·ªânh/Th√†nh ph·ªë --</option>
    </select>

    <label>Ch·ªçn Qu·∫≠n/Huy·ªán:</label>
    <select id="districtSelect" disabled>
        <option value="">-- Ch·ªçn Qu·∫≠n/Huy·ªán --</option>
    </select>

    <h3>Response Data:</h3>
    <pre id="result"></pre>

    <script>
        const API_BASE = 'https://provinces.open-api.vn/api';
        const status = document.getElementById('status');
        const result = document.getElementById('result');
        const provinceSelect = document.getElementById('provinceSelect');
        const districtSelect = document.getElementById('districtSelect');

        async function loadProvinces() {
            try {
                status.textContent = '‚è≥ Loading provinces...';
                console.log('Fetching:', `${API_BASE}/p/`);

                const response = await fetch(`${API_BASE}/p/`);
                console.log('Response status:', response.status);

                const provinces = await response.json();
                console.log('Provinces:', provinces);

                status.textContent = `‚úÖ Loaded ${provinces.length} provinces`;
                result.textContent = JSON.stringify(provinces.slice(0, 3), null, 2);

                // Populate select
                provinces.forEach(province => {
                    const option = document.createElement('option');
                    option.value = province.code;
                    option.textContent = province.name;
                    provinceSelect.appendChild(option);
                });

            } catch (error) {
                status.textContent = '‚ùå Error: ' + error.message;
                result.textContent = error.stack;
                console.error(error);
            }
        }

        async function loadDistricts(provinceCode) {
            if (!provinceCode) {
                districtSelect.disabled = true;
                districtSelect.innerHTML = '<option value="">-- Ch·ªçn Qu·∫≠n/Huy·ªán --</option>';
                return;
            }

            try {
                status.textContent = `‚è≥ Loading districts for province ${provinceCode}...`;
                console.log('Fetching:', `${API_BASE}/p/${provinceCode}?depth=2`);

                const response = await fetch(`${API_BASE}/p/${provinceCode}?depth=2`);
                console.log('Response status:', response.status);

                const province = await response.json();
                console.log('Province data:', province);

                const districts = province.districts || [];
                status.textContent = `‚úÖ Loaded ${districts.length} districts`;
                result.textContent = JSON.stringify(districts.slice(0, 3), null, 2);

                // Populate select
                districtSelect.innerHTML = '<option value="">-- Ch·ªçn Qu·∫≠n/Huy·ªán --</option>';
                districtSelect.disabled = false;

                districts.forEach(district => {
                    const option = document.createElement('option');
                    option.value = district.code;
                    option.textContent = district.name;
                    districtSelect.appendChild(option);
                });

            } catch (error) {
                status.textContent = '‚ùå Error: ' + error.message;
                result.textContent = error.stack;
                console.error(error);
            }
        }

        // Auto load
        loadProvinces();
    </script>
</body>

</html>