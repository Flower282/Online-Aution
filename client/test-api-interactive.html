<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Vietnam API - Interactive</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        select {
            padding: 8px;
            margin: 10px 0;
            width: 300px;
            font-size: 14px;
        }

        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            max-height: 400px;
            overflow: auto;
        }

        label {
            display: block;
            font-weight: bold;
            margin-top: 15px;
        }

        .info {
            color: #666;
            font-size: 12px;
            margin-top: 5px;
        }
    </style>
</head>

<body>
    <h1>Test API 34tinhthanh.com - Interactive Test</h1>

    <label for="provinceSelect">Ch·ªçn T·ªânh/Th√†nh ph·ªë:</label>
    <select id="provinceSelect" onchange="loadDistricts(this.value)">
        <option value="">-- Ch·ªçn T·ªânh/Th√†nh ph·ªë --</option>
    </select>
    <div class="info" id="provinceInfo"></div>

    <label for="districtSelect">Ch·ªçn Qu·∫≠n/Huy·ªán:</label>
    <select id="districtSelect" disabled>
        <option value="">-- Ch·ªçn Qu·∫≠n/Huy·ªán --</option>
    </select>
    <div class="info" id="districtInfo"></div>

    <h3>Response Data:</h3>
    <pre id="result"></pre>

    <script>
        const API_BASE = 'https://34tinhthanh.com/api';
        const resultDiv = document.getElementById('result');
        const provinceSelect = document.getElementById('provinceSelect');
        const districtSelect = document.getElementById('districtSelect');
        const provinceInfo = document.getElementById('provinceInfo');
        const districtInfo = document.getElementById('districtInfo');

        async function loadProvinces() {
            try {
                console.log('üîÑ Loading provinces...');
                const response = await fetch(`${API_BASE}/provinces`);
                const data = await response.json();
                console.log('‚úÖ Provinces:', data);

                // Show first 3 items in result
                resultDiv.textContent = 'Provinces (first 3):\n' + JSON.stringify(data.slice(0, 3), null, 2);

                // Populate select
                provinceSelect.innerHTML = '<option value="">-- Ch·ªçn T·ªânh/Th√†nh ph·ªë --</option>';
                data.forEach(province => {
                    const option = document.createElement('option');
                    option.value = province.province_code;
                    option.textContent = province.name;
                    provinceSelect.appendChild(option);
                });

                provinceInfo.textContent = `Loaded ${data.length} provinces`;
            } catch (error) {
                resultDiv.textContent = 'Error: ' + error.message;
                console.error('‚ùå Error:', error);
            }
        }

        async function loadDistricts(provinceCode) {
            if (!provinceCode) {
                districtSelect.disabled = true;
                districtSelect.innerHTML = '<option value="">-- Ch·ªçn Qu·∫≠n/Huy·ªán --</option>';
                districtInfo.textContent = '';
                return;
            }

            try {
                console.log('üîÑ Loading districts for province:', provinceCode);
                const response = await fetch(`${API_BASE}/districts?province_code=${provinceCode}`);
                const data = await response.json();
                console.log('‚úÖ Districts:', data);
                console.log('üìã District fields:', data.length > 0 ? Object.keys(data[0]) : 'No data');

                // Show first 3 items in result
                resultDiv.textContent = `Districts for province ${provinceCode} (first 3):\n` +
                    JSON.stringify(data.slice(0, 3), null, 2);

                // Populate select
                districtSelect.innerHTML = '<option value="">-- Ch·ªçn Qu·∫≠n/Huy·ªán --</option>';
                districtSelect.disabled = false;

                data.forEach(district => {
                    const option = document.createElement('option');
                    option.value = district.district_code;
                    // Try different field names
                    option.textContent = district.district_name || district.name || district.district_code;
                    districtSelect.appendChild(option);
                });

                districtInfo.textContent = `Loaded ${data.length} districts`;
            } catch (error) {
                resultDiv.textContent = 'Error loading districts: ' + error.message;
                console.error('‚ùå Error:', error);
            }
        }

        // Auto load provinces on page load
        loadProvinces();
    </script>
</body>

</html>